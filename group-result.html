<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì „ì²´ ìš”ì•½</title>
    <link rel="stylesheet" href="meetmate.css" />
    <script src="meetmate.js"></script>
    <style>
      .content {
        padding: 20px 50px;
        margin-right: 300px;
        width: 1200px;
      }
      .content h2 {
        padding-top: 50px;
        text-align: center;
      }
      .summary-grid {
        padding-top: 50px;
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        justify-content: flex-start;
      }

      .summary-grid .section {
        flex: 1 1 340px; /* ìµœì†Œ 300px, ë‚¨ëŠ” ê³µê°„ ì‚¬ìš© */
        width: 340px;
        max-width: 340px; /* ë„ˆë¬´ ë„“ì–´ì§€ì§€ ì•Šë„ë¡ ì œí•œ */
        background: #fff;
        padding: 16px;
        border-radius: 10px;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
      }

      @media (max-width: 768px) {
        .horizontal-sections {
          flex-direction: column;
        }
      }

      .section h3 {
        font-size: 20px;
        margin-bottom: 12px;
      }
      .card {
        border: 1px solid #ddd;
        background: #fff;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 12px;
      }
      .summary-table {
        width: 100%;
        border-collapse: collapse;
      }
      .summary-table th,
      .summary-table td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }
      .link-button {
        margin-top: 8px;
        display: inline-block;
        padding: 6px 12px;
        background: #eee;
        border: 1px solid #ccc;
        border-radius: 4px;
        text-decoration: none;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>
        <a href="main-home.html" style="text-decoration: none; color: inherit"
          >MeetMate</a
        >
      </h1>
      <nav class="topnav">
        <ul>
          <li><a href="group.html">ì¼ì • ì¡°ìœ¨</a></li>
          <li><a href="program.html">ì—­í•  ë¶„ë‹´</a></li>
          <li><a href="map.html">íšŒì˜ ì¥ì†Œ</a></li>
          <li><a href="file-share.html">ìë£Œ ê³µìœ </a></li>
          <li class="active"><a href="group-result.html">ì „ì²´ ìš”ì•½</a></li>
        </ul>
      </nav>
      <div class="top-buttons" id="auth-buttons">
        <!-- ë™ì ìœ¼ë¡œ ë‚´ìš© ì‚½ì…ë¨ -->
      </div>
    </header>

    <div class="main-container">
      <div class="content">
        <h2>ì„ íƒ ê²°ê³¼ ìš”ì•½</h2>

        <div class="summary-grid">
          <div class="section">
            <h3>ğŸ§‘â€ğŸ¤â€ğŸ§‘ ì—­í•  ë¶„ë‹´</h3>
            <table class="summary-table">
              <thead>
                <tr>
                  <th>íŒ€ì›</th>
                  <th>ì—­í• </th>
                  <th>í•  ì¼</th>
                  <th>D-day</th>
                  <th>ë©”ëª¨</th>
                </tr>
              </thead>
              <tbody id="role-summary">
                <tr>
                  <td colspan="5">ë°ì´í„° ì—†ìŒ</td>
                </tr>
              </tbody>
            </table>
            <a class="link-button" href="program.html">ì—­í•  ìˆ˜ì •í•˜ëŸ¬ ê°€ê¸°</a>
          </div>

          <div class="section">
            <h3>íšŒì˜ ì¼ì •</h3>
            <div class="card" id="schedule-summary">
              ì„ íƒëœ ì‹œê°„ì´ ì—†ìŠµë‹ˆë‹¤.
            </div>
            <a class="link-button" href="group.html">ì¼ì • ìˆ˜ì •í•˜ëŸ¬ ê°€ê¸°</a>
          </div>

          <div class="section">
            <h3>íšŒì˜ ì¥ì†Œ</h3>
            <div class="card" id="location-summary">
              ì„ íƒëœ íšŒì˜ ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.
            </div>
            <a class="link-button" href="map.html">íšŒì˜ ì¥ì†Œ ì„ íƒí•˜ëŸ¬ ê°€ê¸°</a>
          </div>
        </div>
      </div>
      <div class="side-panel">
        <div class="card">
          <div id="today-date">ğŸ“… ì˜¤ëŠ˜ ë‚ ì§œ: -</div>
          <div id="current-time">ğŸ•’ í˜„ì¬ ì‹œê°„: -</div>
        </div>
        <div class="card motivation">
          ğŸ©¶ ì˜¤ëŠ˜ë„ ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”!<br />í•¨ê»˜í•˜ëŠ” ì¼ì •ì€ ë” ì†Œì¤‘í•´ìš”.
        </div>
      </div>
    </div>
    <script>
      function saveRoleSummary() {
        const table = document.querySelector("#role-summary");
        const rows = table.querySelectorAll("tr");
        const data = [];

        rows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          if (cells.length >= 5) {
            const team = cells[0].innerText.trim();
            const role = cells[1].innerText.trim();
            const task = cells[2].innerText.trim();
            const dday = cells[3].innerText.trim();
            const memo = cells[4].innerText.trim();

            data.push({ team, role, task, dday, memo });
          }
        });

        localStorage.setItem("roleSummary", JSON.stringify(data));
      }

      function loadRoleSummary() {
        const data = JSON.parse(localStorage.getItem("roleSummary") || "[]");
        const tbody = document.querySelector("#role-summary");
        tbody.innerHTML = "";

        if (data.length === 0) {
          tbody.innerHTML = '<tr><td colspan="5">ë°ì´í„° ì—†ìŒ</td></tr>';
          return;
        }

        let lastTeam = "";
        let lastRole = "";

        data.forEach((item, idx) => {
          const isFirstOfGroup =
            item.team !== lastTeam || item.role !== lastRole;
          lastTeam = item.team;
          lastRole = item.role;

          const tr = document.createElement("tr");
          tr.innerHTML = `
    <td>${isFirstOfGroup ? item.team : ""}</td>
    <td>${isFirstOfGroup ? item.role : ""}</td>
    <td>${item.task}</td>
    <td>${item.dday}</td>
    <td>${item.memo}</td>
  `;
          tbody.appendChild(tr);
        });
      }
      const username = localStorage.getItem("user");
      const topArea = document.getElementById("auth-buttons");

      if (username && username !== "null") {
        topArea.innerHTML = `
      <span>${username}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤</span>
      <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
    `;
      } else {
        topArea.innerHTML = `
      <button onclick="window.location.href='login.html'">ë¡œê·¸ì¸</button>
    `;
      }

      function logout() {
        localStorage.removeItem("user");
        location.reload();
      }
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
      document.addEventListener("DOMContentLoaded", loadRoleSummary);
      // ì¥ì†Œ ë¶ˆëŸ¬ì˜¤ê¸°
      const place = JSON.parse(localStorage.getItem("selectedMeetingPlace"));
      if (place) {
        document.getElementById(
          "location-summary"
        ).textContent = `ğŸ“ ${place.name} (${place.address})`;
      }
    </script>
  </body>
</html>
